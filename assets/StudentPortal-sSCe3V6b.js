import{c as x,r as l,o as P,j as e,C as A,S as h,X as V,M as F,e as q,q as G,i as H,h as O,w as Q,k as T}from"./index-6UyNIvRV.js";import{f as C,Q as U}from"./helpers-B7AfeoQM.js";import{D as I,Q as S,L as B}from"./index-_q5DWrFq.js";import{A as $,C as D,E as W,h as X,a as Y}from"./html2canvas.esm-BcB18Xra.js";const K=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],R=x("copy",K);const Z=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],J=x("file-text",Z);const ee=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],se=x("linkedin",ee);const ae=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],te=x("message-circle",ae);const re=[["path",{d:"M8.3 10a.7.7 0 0 1-.626-1.079L11.4 3a.7.7 0 0 1 1.198-.043L16.3 8.9a.7.7 0 0 1-.572 1.1Z",key:"1bo67w"}],["rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",key:"1bkyp8"}],["circle",{cx:"17.5",cy:"17.5",r:"3.5",key:"w3z12y"}]],ce=x("shapes",re),oe=()=>{const[f,j]=l.useState([]),[M,m]=l.useState(!0),[b,N]=l.useState(""),[s,p]=l.useState(null),[z,w]=l.useState(!1),[g,v]=l.useState(!1),u=l.useRef(null);l.useEffect(()=>{const a=async t=>{if(t?.email){m(!0);try{const r=G(H(O,"certificates"),Q("email","==",t.email)),i=(await T(r)).docs.map(d=>({id:d.id,...d.data()})).sort((d,o)=>(o.timestamp?.seconds||0)-(d.timestamp?.seconds||0));j(i),N("")}catch(r){console.error("Error fetching student certificates:",r),N("Failed to load your certificates. Please try again later.")}finally{m(!1)}}},c=P(q,t=>{t?a(t):(j([]),m(!1))});return()=>c()},[]);const k=a=>{const c=`${window.location.origin}/verify/${a}`;navigator.clipboard.writeText(c),w(!0),setTimeout(()=>w(!1),2e3)},L=a=>{const c=document.querySelector(`#qr-${a}`),t=new XMLSerializer().serializeToString(c),r=document.createElement("canvas"),n=r.getContext("2d"),i=new Image;i.onload=()=>{r.width=i.width,r.height=i.height,n.drawImage(i,0,0);const d=r.toDataURL("image/png"),o=document.createElement("a");o.download=`QR_${a}.png`,o.href=d,o.click()},i.src="data:image/svg+xml;base64,"+btoa(t)},E=async()=>{if(u.current){v(!0);try{const c=(await X(u.current,{scale:2,useCORS:!0,backgroundColor:"#ffffff"})).toDataURL("image/png"),t=new Y("l","mm","a4"),r=t.getImageProperties(c),n=t.internal.pageSize.getWidth(),i=r.height*n/r.width;t.addImage(c,"PNG",0,0,n,i),t.save(`Certificate_${s.certId}.pdf`)}catch(a){console.error("PDF generation failed:",a)}finally{v(!1)}}},y=(a,c)=>{const t=`${window.location.origin}/verify/${c.certId}`,r=`Check out my verified blockchain certificate for ${c.courseName}!`,n={whatsapp:`https://wa.me/?text=${encodeURIComponent(r+" "+t)}`,linkedin:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(t)}`,email:`mailto:?subject=${encodeURIComponent("My Verified Certificate")}&body=${encodeURIComponent(r+`

Verify here: `+t)}`};window.open(n[a],"_blank")},_=()=>e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm space-y-4 animate-pulse",children:[e.jsx("div",{className:"h-12 w-12 bg-gray-100 rounded-2xl"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 w-3/4 bg-gray-100 rounded"}),e.jsx("div",{className:"h-3 w-1/2 bg-gray-100 rounded"})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-50 flex justify-between",children:[e.jsx("div",{className:"h-8 w-20 bg-gray-100 rounded-lg"}),e.jsx("div",{className:"h-8 w-20 bg-gray-100 rounded-lg"})]})]});return M?e.jsxs("div",{className:"py-12 space-y-10",children:[e.jsxs("header",{className:"space-y-2",children:[e.jsx("div",{className:"h-10 w-48 bg-gray-100 rounded-xl animate-pulse"}),e.jsx("div",{className:"h-4 w-64 bg-gray-50 rounded animate-pulse"})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:[1,2,3].map(a=>e.jsx(_,{},a))})]}):b?e.jsxs("div",{className:"py-20 flex flex-col items-center text-center space-y-6",children:[e.jsx("div",{className:"bg-red-50 p-6 rounded-full text-error",children:e.jsx(A,{className:"h-12 w-12"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900",children:"Oops! Something went wrong"}),e.jsx("p",{className:"text-gray-500 mt-2",children:b})]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-primary text-white px-8 py-3 rounded-2xl font-bold hover:bg-blue-600 transition shadow-lg shadow-blue-100",children:"Try Again"})]}):e.jsxs("div",{className:"py-12 space-y-12",children:[e.jsxs("header",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 px-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"inline-flex items-center space-x-2 bg-blue-50 text-primary px-4 py-1.5 rounded-full text-xs font-black uppercase tracking-widest",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{children:"Personal Inventory"})]}),e.jsx("h1",{className:"text-4xl font-black text-gray-900 tracking-tight",children:"Student Portal"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Verify, share, and manage your academic achievements."})]}),e.jsxs("div",{className:"bg-white p-4 rounded-3xl border border-gray-100 shadow-sm flex items-center space-x-3",children:[e.jsx("div",{className:"bg-green-50 p-2 rounded-xl text-success",children:e.jsx(D,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Global Status"}),e.jsx("p",{className:"text-sm font-bold text-gray-900",children:"All Records Verified"})]})]})]}),e.jsx("section",{className:"px-4",children:f.length===0?e.jsxs("div",{className:"py-24 flex flex-col items-center text-center space-y-8 bg-gray-50/50 rounded-[4rem] border-2 border-dashed border-gray-100",children:[e.jsxs("div",{className:"bg-white p-10 rounded-[3rem] shadow-xl shadow-gray-200/50 relative",children:[e.jsx(ce,{className:"h-20 w-20 text-gray-100"}),e.jsx(h,{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 h-10 w-10 text-gray-200"})]}),e.jsxs("div",{className:"max-w-xs space-y-2",children:[e.jsx("h3",{className:"text-2xl font-black text-gray-900",children:"No certificates yet"}),e.jsx("p",{className:"text-gray-500 font-medium leading-relaxed",children:"Your credentials will appear here automatically once issued by your authorized institution."})]})]}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:f.map(a=>e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-125 transition duration-700 pointer-events-none",children:e.jsx($,{className:"h-32 w-32"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"h-14 w-14 bg-blue-50 text-primary rounded-2xl flex items-center justify-center shadow-inner group-hover:bg-primary group-hover:text-white transition duration-500",children:e.jsx(J,{className:"h-7 w-7"})}),e.jsxs("span",{className:"bg-green-50 text-success px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest flex items-center gap-1",children:[e.jsx(h,{className:"h-3 w-3"}),"Verified"]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 leading-tight group-hover:text-primary transition-colors line-clamp-2",children:a.courseName}),e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:a.studentName})]}),e.jsxs("div",{className:"flex items-center gap-6 pt-2 border-t border-gray-50",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-300 uppercase tracking-widest",children:"Issue Date"}),e.jsx("span",{className:"text-sm font-bold text-gray-900",children:C(a.issueDate)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-300 uppercase tracking-widest",children:"Grade"}),e.jsx("span",{className:"text-sm font-bold text-primary",children:a.grade})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[e.jsxs("button",{onClick:()=>p(a),className:"flex items-center justify-center space-x-2 py-3 bg-gray-900 text-white rounded-xl text-xs font-black hover:bg-black transition active:scale-95",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{children:"Details"})]}),e.jsxs("button",{onClick:()=>p(a),className:"flex items-center justify-center space-x-2 py-3 bg-gray-100 text-gray-600 rounded-xl text-xs font-black hover:bg-gray-200 transition active:scale-95",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:"Export"})]})]})]})]},a.id))})}),s&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-gray-900/60 backdrop-blur-xl p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-[2rem] md:rounded-[3rem] shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto relative animate-in zoom-in-95 duration-300 scrollbar-hide",children:[e.jsx("button",{onClick:()=>p(null),className:"absolute top-6 right-6 p-3 bg-gray-50 text-gray-400 hover:text-gray-900 rounded-2xl transition z-20",children:e.jsx(V,{className:"h-6 w-6"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 h-full",children:[e.jsxs("div",{className:"md:col-span-2 bg-gray-50/50 p-6 md:p-10 flex flex-col items-center justify-center space-y-8 border-b md:border-b-0 md:border-r border-gray-100",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-4 bg-primary/10 rounded-[3rem] blur-2xl group-hover:bg-primary/20 transition duration-700"}),e.jsx("div",{className:"relative bg-white p-5 rounded-[2.5rem] shadow-xl border-4 border-white shadow-blue-100/50",children:e.jsx(S,{id:`qr-${s.certId}`,value:`${window.location.origin}/verify/${s.certId}`,size:200,level:"H",includeMargin:!0,fgColor:"#1E40AF"})})]}),e.jsxs("div",{className:"text-center space-y-4 w-full",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-400",children:"Registry Reference"}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 bg-white px-4 py-2 rounded-xl border border-gray-100 mt-1",children:[e.jsx("span",{className:"font-mono text-xs font-black text-primary truncate max-w-[120px]",children:s.certId}),e.jsx("button",{onClick:()=>k(s.certId),className:"text-gray-400 hover:text-primary transition",children:z?e.jsx(D,{className:"h-4 w-4 text-success"}):e.jsx(R,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"pt-4 grid grid-cols-1 gap-3",children:[e.jsxs("button",{onClick:()=>L(s.certId),className:"w-full py-3 px-4 bg-white border-2 border-gray-100 rounded-xl text-xs font-black text-gray-700 hover:border-primary hover:text-primary transition flex items-center justify-center space-x-2",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{children:"Download QR as PNG"})]}),e.jsxs("a",{href:`https://amoy.polygonscan.com/tx/${s.txHash}`,target:"_blank",rel:"noopener noreferrer",className:"w-full py-3 px-4 bg-blue-50 text-primary rounded-xl text-xs font-black hover:bg-blue-100 transition flex items-center justify-center space-x-2",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx("span",{children:"View Blockchain Proof"})]})]})]})]}),e.jsxs("div",{className:"md:col-span-3 p-6 md:p-10 space-y-10",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{children:[e.jsx("h2",{className:"text-3xl font-black text-gray-900 tracking-tight",children:s.courseName}),e.jsxs("p",{className:"text-gray-500 font-medium",children:["Issued by ",s.institutionName||`Institution #${s.issuerId.slice(-4)}`]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 bg-gray-50 p-6 rounded-3xl",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Student Name"}),e.jsx("p",{className:"font-bold text-gray-900",children:s.studentName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Grade Achieved"}),e.jsx("p",{className:"font-bold text-primary",children:s.grade})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-gray-400",children:"Share This Merit"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("button",{onClick:()=>y("linkedin",s),className:"h-14 w-14 bg-blue-600 text-white rounded-2xl flex items-center justify-center hover:scale-110 active:scale-95 transition shadow-lg shadow-blue-200",children:e.jsx(se,{className:"h-6 w-6"})}),e.jsx("button",{onClick:()=>y("whatsapp",s),className:"h-14 w-14 bg-green-500 text-white rounded-2xl flex items-center justify-center hover:scale-110 active:scale-95 transition shadow-lg shadow-green-200",children:e.jsx(te,{className:"h-6 w-6"})}),e.jsx("button",{onClick:()=>y("email",s),className:"h-14 w-14 bg-gray-900 text-white rounded-2xl flex items-center justify-center hover:scale-110 active:scale-95 transition shadow-lg shadow-gray-200",children:e.jsx(F,{className:"h-6 w-6"})}),e.jsx("button",{onClick:()=>k(s.certId),className:"h-14 w-14 bg-white border-2 border-gray-100 text-gray-900 rounded-2xl flex items-center justify-center hover:scale-110 active:scale-95 transition shadow-md",children:e.jsx(R,{className:"h-6 w-6"})})]})]}),e.jsx("div",{className:"pt-6 border-t border-gray-50 space-y-4",children:e.jsxs("button",{onClick:E,disabled:g,className:"w-full py-5 bg-primary text-white rounded-[1.8rem] font-black text-lg hover:bg-blue-600 transition shadow-xl shadow-blue-100 flex items-center justify-center space-x-3 disabled:opacity-50",children:[g?e.jsx(B,{className:"h-6 w-6 animate-spin"}):e.jsx(I,{className:"h-6 w-6"}),e.jsx("span",{children:g?"Formatting Certificate...":"Download Official PDF"})]})}),e.jsx("div",{className:"hidden",children:e.jsxs("div",{ref:u,className:"w-[1000px] p-20 bg-white border-[20px] border-blue-50 flex flex-col items-center text-center space-y-10 font-sans",children:[e.jsxs("div",{className:"w-full flex justify-between items-start",children:[e.jsx(h,{className:"h-16 w-16 text-primary"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-bold text-gray-300 tracking-widest uppercase",children:"Official Record"}),e.jsx("p",{className:"text-xs font-mono text-gray-400",children:s?.certId})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-6xl font-black text-gray-900 tracking-tighter",children:"Certificate of Completion"}),e.jsx("div",{className:"h-1.5 w-40 bg-primary mx-auto rounded-full"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-xl text-gray-400 font-medium italic",children:"This is to certify that"}),e.jsx("h2",{className:"text-5xl font-black text-primary",children:s?.studentName}),e.jsx("p",{className:"text-xl text-gray-400 font-medium max-w-2xl mx-auto",children:"has successfully completed the requirements for the course"}),e.jsx("h3",{className:"text-3xl font-bold text-gray-900",children:s?.courseName}),e.jsxs("div",{className:"flex justify-center gap-12 pt-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-gray-300",children:"Grade"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:s?.grade})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-gray-300",children:"Institution"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:s?.institutionName})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-gray-300",children:"Issue Date"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:C(s?.issueDate)})]})]})]}),e.jsxs("div",{className:"flex flex-col items-center space-y-4 pt-10 border-t border-gray-50 w-full opacity-60",children:[e.jsx(S,{value:`${window.location.origin}/verify/${s?.certId}`,size:80}),e.jsxs("p",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-gray-400",children:["VERIFIED ON POLYGON BLOCKCHAIN â€¢ #",s?.txHash.slice(0,12),"..."]})]})]})})]})]})]})})]})};export{oe as default};
